

"""
rq_kernel function created by kernel_coder(). Requires 2 hyperparameters. Likely created using rq_kernel_base() as an input. 
Use with include("src/kernels/rq_kernel.jl").
hyperparameters == ["α", "μ"]
"""
function rq_kernel(
    hyperparameters::Vector{<:Real}, 
    δ::Real; 
    dorder::Vector{<:Integer}=zeros(Int64, length(hyperparameters) + 2))

    @assert length(hyperparameters)==2 "hyperparameters is the wrong length"
    @assert length(dorder)==(2 + 2) "dorder is the wrong length"
    even_time_derivative = powers_of_negative_one(dorder[2])
    @assert maximum(dorder) < 3 "No more than two time derivatives for either t1 or t2 can be calculated"

    dorder[1] = sum(dorder[1:2])
    dorder[2:(end - 1)] = dorder[3:end]

    deleteat!(dorder, length(dorder))

    α = hyperparameters[1]
    μ = hyperparameters[2]

    if dorder==[4, 0, 2]
        func = -6*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 42*δ^2*μ*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-123/4)*δ^4*μ^2*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + (-11/2)*δ^6*μ^3*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4 + (-1/4)*δ^8*μ^4*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*(-5 - α)*(1 + (1/2)*δ^2*μ/α)^(-6 - α)/α^5
    end

    if dorder==[3, 0, 2]
        func = -6*δ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 12*δ^3*μ*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-15/4)*δ^5*μ^2*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + (-1/4)*δ^7*μ^3*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4
    end

    if dorder==[2, 0, 2]
        func = -3*δ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-9/4)*δ^4*μ*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-1/4)*δ^6*μ^2*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[1, 0, 2]
        func = -δ^3*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-1/4)*δ^5*μ*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2
    end

    if dorder==[0, 0, 2]
        func = (-1/4)*δ^4*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[4, 1, 1]
        func = 6*μ*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 6*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 6*μ*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 3*μ^2*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (39/2)*δ^2*μ^2*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 18*δ^2*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (75/2)*δ^2*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 + 7*δ^4*μ^3*(-3 - α)*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + 7*δ^4*μ^3*(-3 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + 4*δ^4*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 18*δ^2*μ^2*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-3/2)*δ^2*μ^2*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 6*δ^2*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-3 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 18*δ^4*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 + (1/2)*δ^6*μ^4*(-4 - α)*(-3 - α)*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4 + (1/2)*δ^6*μ^4*(-4 - α)*(-3 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4 + (1/2)*δ^6*μ^4*(-4 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4 - 4*δ^4*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 3*δ^4*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-4 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + (3/2)*δ^6*μ^4*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^5 + (-1/2)*δ^6*μ^4*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4
    end

    if dorder==[3, 1, 1]
        func = 6*δ*μ*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 6*δ*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 + (9/2)*δ^3*μ^2*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 3*δ^3*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 6*δ*μ*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 3*δ*μ^2*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (15/2)*δ^3*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 + (1/2)*δ^5*μ^3*(-3 - α)*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + (1/2)*δ^5*μ^3*(-3 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 3*δ^3*μ^2*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-3/2)*δ^3*μ^2*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - δ^3*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-3 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + δ^5*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 + (-1/2)*δ^5*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[2, 1, 1]
        func = -((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-1 - α) - μ*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-1 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-1 - α) + 2*δ^2*μ*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 2*δ^2*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 + (1/2)*δ^4*μ^2*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 2*δ^2*μ*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-1/2)*δ^2*μ*(-1 - α)*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - δ^2*μ^2*(-1 - α)*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (1/2)*δ^4*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 + (-1/2)*δ^4*μ^2*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2
    end

    if dorder==[1, 1, 1]
        func = -δ*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-1 - α) - δ*μ*((-1/2)*δ^2/(α*(1 + (1/2)*δ^2*μ/α)) + (-1/2)*δ^2*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) + (1/4)*δ^4*μ*(-1 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)^2))*(1 + (1/2)*δ^2*μ/α)^(-1 - α) + (-1/2)*δ^3*μ*(-1 - α)*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[0, 1, 1]
        func = (-1/2)*δ^2*(1 + (1/2)*δ^2*μ/α)^(-1 - α)*((1/2)*δ^2*μ/(α*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2
    end

    if dorder==[4, 0, 1]
        func = -6*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-39/2)*δ^2*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 7*δ^4*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + (-1/2)*δ^6*μ^4*(-4 - α)*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-5 - α)/α^4
    end

    if dorder==[3, 0, 1]
        func = -6*δ*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-9/2)*δ^3*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + (-1/2)*δ^5*μ^3*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[2, 0, 1]
        func = (-5/2)*δ^2*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + (-1/2)*δ^4*μ^2*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - (1 + (1/2)*δ^2*μ/α)^(-1 - α)
    end

    if dorder==[1, 0, 1]
        func = -δ*(1 + (1/2)*δ^2*μ/α)^(-1 - α) + (-1/2)*δ^3*μ*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[0, 0, 1]
        func = (-1/2)*δ^2*(1 + (1/2)*δ^2*μ/α)^(-1 - α)
    end

    if dorder==[4, 2, 0]
        func = -6*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 6*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^3 + 6*μ^2*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 12*δ^2*μ^3*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 6*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 3*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-2 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α - 3*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 24*δ^2*μ^3*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - 24*δ^2*μ^3*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - 2*δ^4*μ^4*(-3 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 2*δ^4*μ^4*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 2*δ^4*μ^4*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 36*δ^2*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^4 + 12*δ^2*μ^3*(-2 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 12*δ^2*μ^3*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 6*δ^4*μ^4*(-3 - α)*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 - 6*δ^4*μ^4*(-3 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 - 6*δ^4*μ^4*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 + 24*δ^2*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - 6*δ^2*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-3 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-3 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α^2 - 6*δ^2*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 12*δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^5 + 2*δ^4*μ^4*(-3 - α)*(-2 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + 2*δ^4*μ^4*(-3 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + 2*δ^4*μ^4*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + 6*δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 - δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-4 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-4 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α^3 - δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[3, 2, 0]
        func = -6*δ*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 2*δ^3*μ^3*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 6*δ*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^3 + 6*δ*μ^2*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 4*δ^3*μ^3*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - 4*δ^3*μ^3*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 + 6*δ*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 3*δ*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-2 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α - 3*δ*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 6*δ^3*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^4 + 2*δ^3*μ^3*(-2 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 2*δ^3*μ^3*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 4*δ^3*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - δ^3*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-3 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-3 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α^2 - δ^3*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2
    end

    if dorder==[2, 2, 0]
        func = -μ*(1 + (1/2)*δ^2*μ/α)^(-1 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-1 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-1 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2)) - μ*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-1 - α) - 2*δ^2*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 2*δ^2*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^3 + 2*δ^2*μ^2*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 2*δ^2*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - δ^2*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-2 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-2 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2))/α - δ^2*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[1, 2, 0]
        func = -δ*μ*(1 + (1/2)*δ^2*μ/α)^(-1 - α)*(δ^2*μ/(α^2*(1 + (1/2)*δ^2*μ/α)) + δ^2*μ*(-1 - α)/(α^3*(1 + (1/2)*δ^2*μ/α)) + (-1/4)*δ^4*μ^2*(-1 - α)/(α^4*(1 + (1/2)*δ^2*μ/α)^2)) - δ*μ*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2*(1 + (1/2)*δ^2*μ/α)^(-1 - α)
    end

    if dorder==[0, 2, 0]
        func = (1 + (1/2)*δ^2*μ/α)^(-α)*((1/2)*δ^2*μ/(α*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))^2 + (1/4)*δ^4*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^3
    end

    if dorder==[4, 1, 0]
        func = 3*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 3*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - 3*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 6*δ^2*μ^3*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 6*δ^2*μ^3*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 12*δ^2*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 + δ^4*μ^4*(-3 - α)*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + δ^4*μ^4*(-3 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 + δ^4*μ^4*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3 - 6*δ^2*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + 3*δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^4 - δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-4 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[3, 1, 0]
        func = 3*δ*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 3*δ*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 + δ^3*μ^3*(-2 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 + δ^3*μ^3*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - 3*δ*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + 2*δ^3*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^3 - δ^3*μ^3*(-2 - α)*(-1 - α)*((-1/2)*δ^2*μ*(-3 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2
    end

    if dorder==[2, 1, 0]
        func = -μ*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-1 - α) + δ^2*μ^2*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α + δ^2*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α^2 - δ^2*μ^2*(-1 - α)*((-1/2)*δ^2*μ*(-2 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[1, 1, 0]
        func = -δ*μ*((-1/2)*δ^2*μ*(-1 - α)/(α^2*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))*(1 + (1/2)*δ^2*μ/α)^(-1 - α)
    end

    if dorder==[0, 1, 0]
        func = (1 + (1/2)*δ^2*μ/α)^(-α)*((1/2)*δ^2*μ/(α*(1 + (1/2)*δ^2*μ/α)) - log(1 + (1/2)*δ^2*μ/α))
    end

    if dorder==[4, 0, 0]
        func = -3*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - 6*δ^2*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2 - δ^4*μ^4*(-3 - α)*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-4 - α)/α^3
    end

    if dorder==[3, 0, 0]
        func = -3*δ*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α - δ^3*μ^3*(-2 - α)*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-3 - α)/α^2
    end

    if dorder==[2, 0, 0]
        func = -μ*(1 + (1/2)*δ^2*μ/α)^(-1 - α) - δ^2*μ^2*(-1 - α)*(1 + (1/2)*δ^2*μ/α)^(-2 - α)/α
    end

    if dorder==[1, 0, 0]
        func = -δ*μ*(1 + (1/2)*δ^2*μ/α)^(-1 - α)
    end

    if dorder==[0, 0, 0]
        func = (1 + (1/2)*δ^2*μ/α)^(-α)
    end

    return even_time_derivative * float(func)  # correcting for amount of t2 derivatives

end


return rq_kernel, 2  # the function handle and the number of kernel hyperparameters
