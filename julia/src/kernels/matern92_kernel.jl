

"""
matern92_kernel function created by kernel_coder(). Requires 1 hyperparameters. Likely created using matern92_kernel_base() as an input. 
Use with include("kernels/matern92_kernel.jl").
hyperparameters == ["kernel_length"]
"""
function matern92_kernel(hyperparameters::AbstractArray{T1,1}, dif::Real; dorder::AbstractArray{T2,1}=zeros(1)) where {T1<:Real, T2<:Real}

    @assert length(hyperparameters)==1 "hyperparameters is the wrong length"
    if dorder==zeros(1)
        dorder = zeros(length(hyperparameters) + 2)
    else
        @assert length(dorder)==(length(hyperparameters) + 2) "dorder is the wrong length"
    end
    dorder = convert(AbstractArray{Int64,1}, dorder)

    kernel_length = hyperparameters[3-2]

    if dorder==[2, 2, 1]
        func = (-2592/35)*exp(-3*dif/kernel_length)/kernel_length^5 + (1944/35)*exp(-3*dif/kernel_length)*dif/kernel_length^6 - 162*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^4 + 162*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^4 + 72*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^3 - 36*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^3 - 54*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2))/kernel_length^3 + 54*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2))/kernel_length^3 - 6*exp(-3*dif/kernel_length)*((-648/35)*dif/kernel_length^4 + (-108/7)*kernel_length^(-3))/kernel_length^2 + 6*exp(-3*dif/kernel_length)*((648/35)*dif/kernel_length^4 + (108/7)*kernel_length^(-3))/kernel_length^2 + 18*exp(-3*dif/kernel_length)*((-324/7)*dif/kernel_length^4 + (-1296/35)*dif^2/kernel_length^5 + (-108/7)*kernel_length^(-3))/kernel_length^2 - 36*exp(-3*dif/kernel_length)*((324/7)*dif/kernel_length^4 + (1296/35)*dif^2/kernel_length^5 + (108/7)*kernel_length^(-3))/kernel_length^2 - 6*exp(-3*dif/kernel_length)*((-2592/35)*dif/kernel_length^5 + (-324/7)*kernel_length^(-4))/kernel_length + 6*exp(-3*dif/kernel_length)*((2592/35)*dif/kernel_length^5 + (324/7)*kernel_length^(-4))/kernel_length + 81*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^4 - 324*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^5 + 162*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^5 - 162*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^5 - 108*exp(-3*dif/kernel_length)*dif*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^4 + 54*exp(-3*dif/kernel_length)*dif*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^4 + 18*exp(-3*dif/kernel_length)*dif*((-648/35)*dif/kernel_length^4 + (-108/7)*kernel_length^(-3))/kernel_length^3 - 18*exp(-3*dif/kernel_length)*dif*((648/35)*dif/kernel_length^4 + (108/7)*kernel_length^(-3))/kernel_length^3 + 243*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^6
    end

    if dorder==[1, 2, 1]
        func = exp(-3*dif/kernel_length)*((-2592/35)*dif/kernel_length^5 + (-324/7)*kernel_length^(-4)) + 36*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^3 - 18*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^3 - 6*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^2 + 3*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^2 + 9*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2))/kernel_length^2 - 18*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2))/kernel_length^2 - 3*exp(-3*dif/kernel_length)*((-324/7)*dif/kernel_length^4 + (-1296/35)*dif^2/kernel_length^5 + (-108/7)*kernel_length^(-3))/kernel_length + 6*exp(-3*dif/kernel_length)*((324/7)*dif/kernel_length^4 + (1296/35)*dif^2/kernel_length^5 + (108/7)*kernel_length^(-3))/kernel_length - 27*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^3 + 81*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^4 - 54*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^4 + 27*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^4 + 18*exp(-3*dif/kernel_length)*dif*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^3 - 9*exp(-3*dif/kernel_length)*dif*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^3 + 3*exp(-3*dif/kernel_length)*dif*((648/35)*dif/kernel_length^4 + (108/7)*kernel_length^(-3))/kernel_length^2 - 81*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^5
    end

    if dorder==[0, 2, 1]
        func = exp(-3*dif/kernel_length)*((-324/7)*dif/kernel_length^4 + (-1296/35)*dif^2/kernel_length^5 + (-108/7)*kernel_length^(-3)) - 6*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^2 + 6*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2))/kernel_length + 9*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^2 - 18*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^3 + 18*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^3 + 3*exp(-3*dif/kernel_length)*dif*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^2 + 27*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^4
    end

    if dorder==[2, 1, 1]
        func = exp(-3*dif/kernel_length)*((2592/35)*dif/kernel_length^5 + (324/7)*kernel_length^(-4)) - 18*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^3 + 36*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^3 + 6*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^2 - 3*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^2 - 18*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2))/kernel_length^2 + 9*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2))/kernel_length^2 + 3*exp(-3*dif/kernel_length)*((-324/7)*dif/kernel_length^4 + (-1296/35)*dif^2/kernel_length^5 + (-108/7)*kernel_length^(-3))/kernel_length - 6*exp(-3*dif/kernel_length)*((324/7)*dif/kernel_length^4 + (1296/35)*dif^2/kernel_length^5 + (108/7)*kernel_length^(-3))/kernel_length + 27*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^3 - 81*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^4 + 27*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^4 - 54*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^4 - 18*exp(-3*dif/kernel_length)*dif*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^3 + 9*exp(-3*dif/kernel_length)*dif*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^3 + 3*exp(-3*dif/kernel_length)*dif*((-648/35)*dif/kernel_length^4 + (-108/7)*kernel_length^(-3))/kernel_length^2 + 81*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^5
    end

    if dorder==[1, 1, 1]
        func = exp(-3*dif/kernel_length)*((324/7)*dif/kernel_length^4 + (1296/35)*dif^2/kernel_length^5 + (108/7)*kernel_length^(-3)) + 3*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^2 - 3*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^2 + 3*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2))/kernel_length - 3*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2))/kernel_length - 9*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^2 + 18*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^3 - 9*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^3 + 9*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^3 + 3*exp(-3*dif/kernel_length)*dif*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^2 - 27*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^4
    end

    if dorder==[0, 1, 1]
        func = exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (162/7)*dif^2/kernel_length^4 + (432/35)*dif^3/kernel_length^5 + 3*kernel_length^(-2)) + 3*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length - 3*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^2 + 3*exp(-3*dif/kernel_length)*dif*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^2 + 9*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^3
    end

    if dorder==[2, 0, 1]
        func = exp(-3*dif/kernel_length)*((-324/7)*dif/kernel_length^4 + (-1296/35)*dif^2/kernel_length^5 + (-108/7)*kernel_length^(-3)) + 6*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^2 - 6*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2))/kernel_length + 9*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length^2 - 18*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^3 - 18*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^3 + 3*exp(-3*dif/kernel_length)*dif*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^2 + 27*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^4
    end

    if dorder==[1, 0, 1]
        func = exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-162/7)*dif^2/kernel_length^4 + (-432/35)*dif^3/kernel_length^5 - 3*kernel_length^(-2)) - 3*exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5)/kernel_length + 3*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^2 + 3*exp(-3*dif/kernel_length)*dif*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^2 - 9*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^3
    end

    if dorder==[0, 0, 1]
        func = exp(-3*dif/kernel_length)*(-3*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-54/7)*dif^3/kernel_length^4 + (-108/35)*dif^4/kernel_length^5) + 3*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)*dif/kernel_length^2
    end

    if dorder==[2, 2, 0]
        func = (648/35)*exp(-3*dif/kernel_length)/kernel_length^4 + 54*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^3 - 54*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^3 - 36*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length^2 + 18*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length^2 + 6*exp(-3*dif/kernel_length)*((-648/35)*dif/kernel_length^4 + (-108/7)*kernel_length^(-3))/kernel_length - 6*exp(-3*dif/kernel_length)*((648/35)*dif/kernel_length^4 + (108/7)*kernel_length^(-3))/kernel_length + 81*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^4
    end

    if dorder==[1, 2, 0]
        func = exp(-3*dif/kernel_length)*((648/35)*dif/kernel_length^4 + (108/7)*kernel_length^(-3)) - 18*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^2 + 9*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^2 + 6*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length - 3*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length - 27*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^3
    end

    if dorder==[0, 2, 0]
        func = exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2)) + 6*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length + 9*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^2
    end

    if dorder==[2, 1, 0]
        func = exp(-3*dif/kernel_length)*((-648/35)*dif/kernel_length^4 + (-108/7)*kernel_length^(-3)) + 9*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length^2 - 18*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length^2 - 6*exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2))/kernel_length + 3*exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2))/kernel_length + 27*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^3
    end

    if dorder==[1, 1, 0]
        func = exp(-3*dif/kernel_length)*((-108/7)*dif/kernel_length^3 + (-324/35)*dif^2/kernel_length^4 + (-54/7)*kernel_length^(-2)) - 3*exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1))/kernel_length + 3*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length - 9*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^2
    end

    if dorder==[0, 1, 0]
        func = exp(-3*dif/kernel_length)*((-54/7)*dif/kernel_length^2 + (-54/7)*dif^2/kernel_length^3 + (-108/35)*dif^3/kernel_length^4 - 3*kernel_length^(-1)) + 3*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length
    end

    if dorder==[2, 0, 0]
        func = exp(-3*dif/kernel_length)*((108/7)*dif/kernel_length^3 + (324/35)*dif^2/kernel_length^4 + (54/7)*kernel_length^(-2)) - 6*exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1))/kernel_length + 9*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length^2
    end

    if dorder==[1, 0, 0]
        func = exp(-3*dif/kernel_length)*((54/7)*dif/kernel_length^2 + (54/7)*dif^2/kernel_length^3 + (108/35)*dif^3/kernel_length^4 + 3*kernel_length^(-1)) - 3*exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)/kernel_length
    end

    if dorder==[0, 0, 0]
        func = exp(-3*dif/kernel_length)*(1 + 3*dif/kernel_length + (27/7)*dif^2/kernel_length^2 + (18/7)*dif^3/kernel_length^3 + (27/35)*dif^4/kernel_length^4)
    end

    return float(func)

end


return matern92_kernel, 1  # the function handle and the number of kernel hyperparameters
