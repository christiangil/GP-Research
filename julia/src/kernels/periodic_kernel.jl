

"""
periodic_kernel function created by kernel_coder(). Requires 2 hyperparameters. Likely created using periodic_kernel_base() as an input. 
Use with include("src/kernels/periodic_kernel.jl").
hyperparameters == ["kernel_period", "kernel_length"]
"""
function periodic_kernel(
    hyperparameters::AbstractArray{T1,1}, 
    dif::Real; 
    dorder::AbstractArray{T2,1}=zeros(Int64, length(hyperparameters) + 2) 
    ) where {T1<:Real, T2<:Integer}

    @assert length(hyperparameters)==2 "hyperparameters is the wrong length"
    @assert length(dorder)==(length(hyperparameters) + 2) "dorder is the wrong length"
    even_time_derivative = 2 * iseven(dorder[2]) - 1
    @assert maximum(dorder) < 3 "No more than two time derivatives for either t1 or t2 can be calculated"

    dorder = append!([sum(dorder[1:2])], dorder[3:end])

    kernel_period = hyperparameters[1]
    kernel_length = hyperparameters[2]

    if dorder==[4, 0, 2]
        func = -96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4) + 1408*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^6) - 2368*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6/(kernel_period^4*kernel_length^8) + 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^8/(kernel_period^4*kernel_length^10) + 96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^6) - 7488*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^6) - 18240*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^8) + 31872*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^8) + 42240*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^10) - 28672*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^10) - 25600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^12) + 6144*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^8*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^12) + 4096*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^8*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^14)
    end

    if dorder==[3, 0, 2]
        func = 96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^4) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^6) - 1408*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^6) - 4800*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^8) + 2368*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^8) + 4608*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^10) - 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^7*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^10) - 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^7*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^12)
    end

    if dorder==[2, 0, 2]
        func = 24*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^4) - 112*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4/(kernel_period^2*kernel_length^6) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^6/(kernel_period^2*kernel_length^8) - 24*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^4) + 432*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^6) - 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^8) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^10)
    end

    if dorder==[1, 0, 2]
        func = -24*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^4) + 112*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^6) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^8)
    end

    if dorder==[0, 0, 2]
        func = -12*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*sin(pi*dif/kernel_period)^2/kernel_length^4 + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*sin(pi*dif/kernel_period)^4/kernel_length^6
    end

    if dorder==[4, 1, 1]
        func = -128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^3) + 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^5) - 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6/(kernel_period^5*kernel_length^7) + 128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^3) + 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^5) - 5888*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^5) - 9984*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^7) + 14848*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^7) + 14336*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^9) - 6144*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^9) - 4096*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^11) - 128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^3) - 3840*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^5) - 5760*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^7) + 4096*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^5) + 30720*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^7) + 24320*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^9) - 9600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^7) - 38400*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^9) - 20480*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^11) + 3840*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^7*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^9) + 10240*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^7*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^11) + 4096*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^7*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^13)
    end

    if dorder==[3, 1, 1]
        func = 96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^3) + 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^5) - 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^5) - 1728*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^7) + 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^7) + 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^9) - 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^3) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^5) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^6/(kernel_period^5*kernel_length^7) + 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^3) + 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^5) - 1472*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^5) - 2496*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^7) + 3712*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^7) + 3584*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^9) - 1536*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^9) - 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^11)
    end

    if dorder==[2, 1, 1]
        func = 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^3) - 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4/(kernel_period^3*kernel_length^5) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^3) + 160*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^5) - 128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^7) + 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^3) + 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^5) - 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^5) - 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^7) + 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^7) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^9)
    end

    if dorder==[1, 1, 1]
        func = -8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^3) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^5) + 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^3) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^4/(kernel_period^3*kernel_length^5) - 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^3) + 80*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^5) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^7)
    end

    if dorder==[0, 1, 1]
        func = -8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^3) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^5)
    end

    if dorder==[4, 0, 1]
        func = 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^3) - 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^5) + 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6/(kernel_period^4*kernel_length^7) - 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^3) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^5) + 1472*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^5) + 2496*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^7) - 3712*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^7) - 3584*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^9) + 1536*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^9) + 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^11)
    end

    if dorder==[3, 0, 1]
        func = -32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^3) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^5) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^5) + 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^7) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^7) - 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^9)
    end

    if dorder==[2, 0, 1]
        func = -8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^3) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4/(kernel_period^2*kernel_length^5) + 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^3) - 80*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^5) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^7)
    end

    if dorder==[1, 0, 1]
        func = 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^3) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^5)
    end

    if dorder==[0, 0, 1]
        func = 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*sin(pi*dif/kernel_period)^2/kernel_length^3
    end

    if dorder==[4, 2, 0]
        func = -320*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) + 320*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) - 7040*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^4) - 7680*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^6) + 7680*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^6) + 5120*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^8) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^2/(kernel_period^8*kernel_length^2) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^4/(kernel_period^8*kernel_length^4) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^6/(kernel_period^8*kernel_length^6) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*cos(pi*dif/kernel_period)^2/(kernel_period^8*kernel_length^2) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*cos(pi*dif/kernel_period)^4/(kernel_period^8*kernel_length^4) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*cos(pi*dif/kernel_period)^6/(kernel_period^8*kernel_length^6) - 640*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^2) - 9600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^4) - 9600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^6) + 9600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^4) + 44800*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^6) + 25600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^8) - 9600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^6) - 25600*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^8) - 10240*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^10) + 6016*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^8*kernel_length^4) + 22080*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^8*kernel_length^6) + 11520*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^6/(kernel_period^8*kernel_length^8) - 22080*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^8*kernel_length^6) - 43520*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^8*kernel_length^8) - 15360*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^6/(kernel_period^8*kernel_length^10) + 11520*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^2/(kernel_period^8*kernel_length^8) + 15360*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^4/(kernel_period^8*kernel_length^10) + 4096*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^6*dif^2*sin(pi*dif/kernel_period)^6*cos(pi*dif/kernel_period)^6/(kernel_period^8*kernel_length^12)
    end

    if dorder==[3, 2, 0]
        func = 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^2) + 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^4) - 576*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^4) - 768*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^6) - 128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) + 128*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) - 2816*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^4) - 3072*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^6) + 3072*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^6) + 2048*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^8) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^2) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^4) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^6) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^4) + 4480*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^6) + 2560*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^8) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^7*kernel_length^6) - 2560*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^7*kernel_length^8) - 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif^2*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^5/(kernel_period^7*kernel_length^10)
    end

    if dorder==[2, 2, 0]
        func = 24*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) - 24*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) + 96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^4) + 96*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^2) + 288*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^4) - 288*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^4) - 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^6) - 352*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^4) - 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^6) + 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^6*kernel_length^6) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif^2*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^6*kernel_length^8)
    end

    if dorder==[1, 2, 0]
        func = -8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif^2*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif^2*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^4) - 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif^2*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^5*kernel_length^4) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif^2*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^5*kernel_length^6)
    end

    if dorder==[0, 2, 0]
        func = 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif^2*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) - 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) - 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4)
    end

    if dorder==[4, 1, 0]
        func = 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^2) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^4) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^2) - 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^4) + 1408*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^4) + 1536*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^6) - 1536*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^6) - 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^8) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^2) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^4) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^6) - 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^4) - 4480*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^6) - 2560*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^8) + 960*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)/(kernel_period^6*kernel_length^6) + 2560*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^3/(kernel_period^6*kernel_length^8) + 1024*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^5*dif*sin(pi*dif/kernel_period)^5*cos(pi*dif/kernel_period)^5/(kernel_period^6*kernel_length^10)
    end

    if dorder==[3, 1, 0]
        func = -48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^2) - 144*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^4) + 144*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^4) + 192*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^6) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^2) - 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^4) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^2) - 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^4) + 352*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^4) + 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^6) - 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^5*kernel_length^6) - 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*dif*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^5*kernel_length^8)
    end

    if dorder==[2, 1, 0]
        func = -8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^2) + 8*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^2) - 32*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^4) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^2) - 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^4) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^4*kernel_length^4) + 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*dif*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^4*kernel_length^6)
    end

    if dorder==[1, 1, 0]
        func = 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^2) + 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*dif*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^3*kernel_length^4)
    end

    if dorder==[0, 1, 0]
        func = 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*dif*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^2*kernel_length^2)
    end

    if dorder==[4, 0, 0]
        func = -16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^4) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^4) - 352*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^4) - 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^6) + 384*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^2/(kernel_period^4*kernel_length^6) + 256*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^4*sin(pi*dif/kernel_period)^4*cos(pi*dif/kernel_period)^4/(kernel_period^4*kernel_length^8)
    end

    if dorder==[3, 0, 0]
        func = 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^2) + 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^4) - 48*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)/(kernel_period^3*kernel_length^4) - 64*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^3*sin(pi*dif/kernel_period)^3*cos(pi*dif/kernel_period)^3/(kernel_period^3*kernel_length^6)
    end

    if dorder==[2, 0, 0]
        func = 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^2) + 16*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi^2*sin(pi*dif/kernel_period)^2*cos(pi*dif/kernel_period)^2/(kernel_period^2*kernel_length^4)
    end

    if dorder==[1, 0, 0]
        func = -4*exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)*pi*sin(pi*dif/kernel_period)*cos(pi*dif/kernel_period)/(kernel_period*kernel_length^2)
    end

    if dorder==[0, 0, 0]
        func = exp(-2*sin(pi*dif/kernel_period)^2/kernel_length^2)
    end

    return even_time_derivative * float(func)  # correcting for amount of t2 derivatives

end


return periodic_kernel, 2  # the function handle and the number of kernel hyperparameters
