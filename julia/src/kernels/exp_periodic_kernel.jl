

"""
exp_periodic_kernel function created by kernel_coder(). Requires 3 hyperparameters. Likely created using exp_periodic_kernel_base() as an input. 
Use with include("kernels/exp_periodic_kernel.jl").
"""
function exp_periodic_kernel(hyperparameters::Union{Array{T1,1},Array{Any,1}}, dif::Real; dorder::Array{T2,1}=zeros(1)) where {T1<:Real, T2<:Real}

    @assert length(hyperparameters)==3 "hyperparameters is the wrong length"
    if dorder==zeros(1)
        dorder = zeros(length(hyperparameters) + 2)
    else
        @assert length(dorder)==(length(hyperparameters) + 2) "dorder is the wrong length"
    end
    dorder = convert(Array{Int64,1}, dorder)

    P_kernel_length = hyperparameters[3-2]
    P_kernel_period = hyperparameters[4-2]
    OU_kernel_length = hyperparameters[5-2]

    if dorder==[2, 2, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*1/((dif^2)^(3/2)*OU_kernel_length^2) + 18*dif^2/((dif^2)^(5/2)*OU_kernel_length^2) - 15*dif^4/((dif^2)^(7/2)*OU_kernel_length^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length^2) + dif^2/((dif^2)^(3/2)*OU_kernel_length^2))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length^2) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length^2))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length^2) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length^2))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length^2) + dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(3*1/((dif^2)^(3/2)*OU_kernel_length) - 18*dif^2/((dif^2)^(5/2)*OU_kernel_length) + 15*dif^4/((dif^2)^(7/2)*OU_kernel_length) - 16*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4))/OU_kernel_length^2 - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))/(abs(dif)*OU_kernel_length^2) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2 - 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/(abs(dif)*OU_kernel_length^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2
    end

    if dorder==[1, 2, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length^2) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length^2) + dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/(abs(dif)*OU_kernel_length^2) - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2 - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2)
    end

    if dorder==[0, 2, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 - 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2)
    end

    if dorder==[2, 1, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length^2) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length^2) + dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))/OU_kernel_length^2 - exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/(abs(dif)*OU_kernel_length^2) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) - exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(abs(dif)*OU_kernel_length^2) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2)
    end

    if dorder==[1, 1, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length^2) + dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 - exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2
    end

    if dorder==[0, 1, 0, 0, 1]
        func = -1.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2
    end

    if dorder==[2, 0, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length^2) - dif^2/((dif^2)^(3/2)*OU_kernel_length^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2/OU_kernel_length^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/OU_kernel_length^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/(abs(dif)*OU_kernel_length^2)
    end

    if dorder==[1, 0, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*dif/(abs(dif)*OU_kernel_length^2) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))/OU_kernel_length^2
    end

    if dorder==[0, 0, 0, 0, 1]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*abs(dif)/OU_kernel_length^2
    end

    if dorder==[2, 2, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(64*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) - 64*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) + 64*pi^5*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^6)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-48*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) - 16*pi^4*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(48*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4) - 16*pi^4*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) + 16*pi^4*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(3*1/((dif^2)^(3/2)*OU_kernel_length) - 18*dif^2/((dif^2)^(5/2)*OU_kernel_length) + 15*dif^4/((dif^2)^(7/2)*OU_kernel_length) - 16*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[1, 2, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-48*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) - 16*pi^4*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[0, 2, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[2, 1, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(48*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4) - 16*pi^4*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5) + 16*pi^4*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^5)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[1, 1, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[0, 1, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[2, 0, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) - 16*pi^3*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^4)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[1, 0, 0, 1, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*dif*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3) + 4*pi^2*dif*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^3)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[0, 0, 0, 1, 0]
        func = 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*dif*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^2)
    end

    if dorder==[2, 2, 1, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(32*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^4) - 32*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^4)) + (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + 2.0*(-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 4.0*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*1/((dif^2)^(3/2)*OU_kernel_length) - 18*dif^2/((dif^2)^(5/2)*OU_kernel_length) + 15*dif^4/((dif^2)^(7/2)*OU_kernel_length) - 16*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) - 64.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi^3*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period^3) + 64.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi^3*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period^3) - 32.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) + 32.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[1, 2, 1, 0, 0]
        func = (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 - 32.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period^3) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[0, 2, 1, 0, 0]
        func = (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 - 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[2, 1, 1, 0, 0]
        func = (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*(8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 32.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period^3) - 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) - 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/(P_kernel_length^3*P_kernel_period) + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[1, 1, 1, 0, 0]
        func = (8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) - 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 - 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period) + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[0, 1, 1, 0, 0]
        func = 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 - 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[2, 0, 1, 0, 0]
        func = (-8*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2) + 8*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^3*P_kernel_period^2))*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))/P_kernel_length^3 + 16.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[1, 0, 1, 0, 0]
        func = 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3 + 8.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^3*P_kernel_period)
    end

    if dorder==[0, 0, 1, 0, 0]
        func = 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*sin(pi*dif/P_kernel_period)^2/P_kernel_length^3
    end

    if dorder==[2, 2, 0, 0, 0]
        func = 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*1/((dif^2)^(3/2)*OU_kernel_length) - 18*dif^2/((dif^2)^(5/2)*OU_kernel_length) + 15*dif^4/((dif^2)^(7/2)*OU_kernel_length) - 16*pi^4*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4) + 16*pi^4*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^4)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period)) + 4.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))
    end

    if dorder==[1, 2, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(3*dif/((dif^2)^(3/2)*OU_kernel_length) - 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) + 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))
    end

    if dorder==[0, 2, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))
    end

    if dorder==[2, 1, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-3*dif/((dif^2)^(3/2)*OU_kernel_length) + 3*dif^3/((dif^2)^(5/2)*OU_kernel_length) - 16*pi^3*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period^3)) + 2.0*exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))
    end

    if dorder==[1, 1, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(1/(abs(dif)*OU_kernel_length) - dif^2/((dif^2)^(3/2)*OU_kernel_length) - 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) + 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2)) + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))
    end

    if dorder==[0, 1, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(dif/(abs(dif)*OU_kernel_length) + 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))
    end

    if dorder==[2, 0, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))^2 + exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-1/(abs(dif)*OU_kernel_length) + dif^2/((dif^2)^(3/2)*OU_kernel_length) + 4*pi^2*sin(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2) - 4*pi^2*cos(pi*dif/P_kernel_period)^2/(P_kernel_length^2*P_kernel_period^2))
    end

    if dorder==[1, 0, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)*(-dif/(abs(dif)*OU_kernel_length) - 4*pi*sin(pi*dif/P_kernel_period)*cos(pi*dif/P_kernel_period)/(P_kernel_length^2*P_kernel_period))
    end

    if dorder==[0, 0, 0, 0, 0]
        func = exp(-2*sin(pi*dif/P_kernel_period)^2/P_kernel_length^2 - abs(dif)/OU_kernel_length)
    end

    return float(func)

end


return exp_periodic_kernel, 3  # the function handle and the number of kernel hyperparameters
