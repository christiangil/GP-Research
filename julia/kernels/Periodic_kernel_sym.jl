

"Periodic_kernel_sym function created by kernel_coder(). Requires 2 hyperparameters."
function Periodic_kernel_sym(hyperparameters::Array{Float64,1}, dif::Float64; dorder::Array{}=zeros(1))

    @assert length(hyperparameters)==2 "hyperparameters is the wrong length"
    if dorder==zeros(1)
        dorder = zeros(length(hyperparameters) + 2)
    else
        @assert length(dorder)==(length(hyperparameters) + 2) "dorder is the wrong length"
    end
    dorder = convert(Array{Int64,1}, dorder)

    kernel_period = hyperparameters[3-2]
    kernel_length = hyperparameters[4-2]

    if dorder==[2, 2, 1, 1]
        func = -128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) + 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) - 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6/(kernel_period^7*kernel_length^5) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) - 5888*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^5) - 9984*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^7*kernel_length^5) + 14848*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^5) + 14336*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^9*kernel_length^5) - 6144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^9*kernel_length^5) - 4096*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^11*kernel_length^5) + 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) + 1728*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) - 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4) - 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length^2) + 288*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length^2) + 120*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^3*kernel_length^2) - 240*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^5*kernel_length^2) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^4) + 2304*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) - 3072*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) - 6912*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) + 2304*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) + 3072*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^4) - 288*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length^4) - 1728*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^5*kernel_length^4) + 2304*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length^4) + 5184*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^7*kernel_length^4) - 1728*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^7*kernel_length^4) - 2304*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^9*kernel_length^4) - 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^6) - 3840*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^6) - 5760*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^7*kernel_length^6) + 4096*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^6) + 30720*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^6) + 24320*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^9*kernel_length^6) - 9600*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^6) - 38400*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^6) - 20480*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^11*kernel_length^6) + 3840*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^7*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^9*kernel_length^6) + 10240*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^7*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^11*kernel_length^6) + 4096*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^7*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^13*kernel_length^6)
    end

    if dorder==[1, 2, 1, 1]
        func = -32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6/(kernel_period^7*kernel_length^5) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) - 1472*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^5) - 2496*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^7*kernel_length^5) + 3712*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^5) + 3584*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^9*kernel_length^5) - 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^9*kernel_length^5) - 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^11*kernel_length^5) + 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) - 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length^2) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length^2) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^3*kernel_length^4) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^5*kernel_length^4) + 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^5*kernel_length^4) + 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^7*kernel_length^4) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^7*kernel_length^4) - 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^9*kernel_length^4) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) + 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) - 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) - 1728*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) + 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^4) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) - 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) - 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) + 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^4)
    end

    if dorder==[0, 2, 1, 1]
        func = 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^3) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) + 160*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^3) - 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^3) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4)
    end

    if dorder==[2, 1, 1, 1]
        func = 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6/(kernel_period^7*kernel_length^5) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^5) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^5) + 1472*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^5) + 2496*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^7*kernel_length^5) - 3712*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^5) - 3584*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^9*kernel_length^5) + 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^9*kernel_length^5) + 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^11*kernel_length^5) - 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) + 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length^2) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length^2) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^3*kernel_length^4) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^5*kernel_length^4) - 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^5*kernel_length^4) - 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^7*kernel_length^4) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^7*kernel_length^4) + 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^9*kernel_length^4) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) + 1728*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) - 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^4) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) + 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^4) + 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^4) - 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^4)
    end

    if dorder==[1, 1, 1, 1]
        func = -16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^3) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) - 160*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^3) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^3) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^2) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) + 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4)
    end

    if dorder==[0, 1, 1, 1]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^3) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) - 80*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^3) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^3) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^2)
    end

    if dorder==[2, 0, 1, 1]
        func = 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^3) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) + 160*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^3) - 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^3) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^2) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^4) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^4) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^4)
    end

    if dorder==[1, 0, 1, 1]
        func = 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^3) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^3) + 80*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^3) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^3) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^2)
    end

    if dorder==[0, 0, 1, 1]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(kernel_period^5*kernel_length^2)
    end

    if dorder==[2, 2, 0, 1]
        func = 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) + 1408*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^5) + 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^6*kernel_length^5) - 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^6*kernel_length^5) - 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^8*kernel_length^5) - 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) + 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) - 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4) + 72*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length^2) - 60*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^2*kernel_length^2) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) + 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^4) + 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length^4) + 432*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^4*kernel_length^4) - 432*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^4*kernel_length^4) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^6*kernel_length^4) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^6) + 960*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^6) + 960*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^6*kernel_length^6) - 960*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^6) - 4480*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^6) - 2560*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^8*kernel_length^6) + 960*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^6*kernel_length^6) + 2560*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^8*kernel_length^6) + 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^5*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^5/((dif^2)^(3/2)*kernel_period^10*kernel_length^6)
    end

    if dorder==[1, 2, 0, 1]
        func = 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) + 352*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^5) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^6*kernel_length^5) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^6*kernel_length^5) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^8*kernel_length^5) - 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) + 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length^2) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^2*kernel_length^4) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^4*kernel_length^4) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^4*kernel_length^4) - 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^6*kernel_length^4) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) - 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) + 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^4) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^4)
    end

    if dorder==[0, 2, 0, 1]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^3) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4)
    end

    if dorder==[2, 1, 0, 1]
        func = -16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^5) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^5) - 352*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^5) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^6*kernel_length^5) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^6*kernel_length^5) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*dif*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^8*kernel_length^5) + 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) - 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length^2) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^2*kernel_length^4) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^4*kernel_length^4) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(dif*kernel_period^4*kernel_length^4) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*abs(dif)*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(dif*kernel_period^6*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) + 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) - 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^4) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^4) - 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^4)
    end

    if dorder==[1, 1, 0, 1]
        func = 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^3) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^2) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4)
    end

    if dorder==[0, 1, 0, 1]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^3) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^2)
    end

    if dorder==[2, 0, 0, 1]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^3) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^4) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^4) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^4)
    end

    if dorder==[1, 0, 0, 1]
        func = -4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^3) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*dif*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^3) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^2)
    end

    if dorder==[0, 0, 0, 1]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*abs(dif)*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(kernel_period^2*kernel_length^2)
    end

    if dorder==[2, 2, 1, 0]
        func = 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^4) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^4) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6/(kernel_period^7*kernel_length^4) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^4) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^4) + 1472*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^4) + 2496*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^7*kernel_length^4) - 3712*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^4) - 3584*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^9*kernel_length^4) + 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^9*kernel_length^4) + 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^6*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^11*kernel_length^4) - 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length^3) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^5*kernel_length^3) - 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length^3) - 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^7*kernel_length^3) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^7*kernel_length^3) + 512*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^9*kernel_length^3) + 144*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length) - 288*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length) - 120*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^3*kernel_length) + 240*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^5*kernel_length) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^3) - 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) + 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) + 3456*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) - 1152*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) - 1536*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^3) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length^3) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^5*kernel_length^3) - 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length^3) - 2304*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^7*kernel_length^3) + 768*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^7*kernel_length^3) + 1024*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^9*kernel_length^3)
    end

    if dorder==[1, 2, 1, 0]
        func = -24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length) + 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^3) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) + 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^3)
    end

    if dorder==[0, 2, 1, 0]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) - 80*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^2) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length)
    end

    if dorder==[2, 1, 1, 0]
        func = 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length) - 24*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^3*kernel_length) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^5*kernel_length) + 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length^3) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) - 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length^3) - 576*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^7*kernel_length^3) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^5*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^9*kernel_length^3)
    end

    if dorder==[1, 1, 1, 0]
        func = 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^2) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) + 80*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^2) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^2) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length)
    end

    if dorder==[0, 1, 1, 0]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length)
    end

    if dorder==[2, 0, 1, 0]
        func = -8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^5*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^3*kernel_length^2) - 80*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^5*kernel_length^2) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^7*kernel_length^2) + 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length) - 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^3*kernel_length) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^5*kernel_length)
    end

    if dorder==[1, 0, 1, 0]
        func = 8*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^3*kernel_length) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^5*kernel_length)
    end

    if dorder==[0, 0, 1, 0]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*sin(pi*abs(dif)/kernel_length)^2/kernel_period^3
    end

    if dorder==[2, 2, 0, 0]
        func = -16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^4) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^4) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^4*kernel_length^4) - 352*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^4) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^6*kernel_length^4) + 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^6*kernel_length^4) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^4*sin(pi*abs(dif)/kernel_length)^4*cos(pi*abs(dif)/kernel_length)^4/(kernel_period^8*kernel_length^4) + 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length) - 32*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length^3) - 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^4*kernel_length^3) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^4*kernel_length^3) + 128*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/(abs(dif)*kernel_period^6*kernel_length^3) - 72*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length) + 60*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(7/2)*kernel_period^2*kernel_length) + 96*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^3) + 288*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) - 288*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) - 384*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^2*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^3) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length^3) - 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^4*kernel_length^3) + 192*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^4*kernel_length^3) + 256*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^4*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(5/2)*kernel_period^6*kernel_length^3)
    end

    if dorder==[1, 2, 0, 0]
        func = 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length) - 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^3) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) - 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^3)
    end

    if dorder==[0, 2, 0, 0]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length)
    end

    if dorder==[2, 1, 0, 0]
        func = -12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length) + 12*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(5/2)*kernel_period^2*kernel_length) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length^3) - 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) + 48*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^4*kernel_length^3) + 64*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^3*dif^3*sin(pi*abs(dif)/kernel_length)^3*cos(pi*abs(dif)/kernel_length)^3/((dif^2)^(3/2)*kernel_period^6*kernel_length^3)
    end

    if dorder==[1, 1, 0, 0]
        func = -4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) - 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^2) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length)
    end

    if dorder==[0, 1, 0, 0]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length)
    end

    if dorder==[2, 0, 0, 0]
        func = 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^2*kernel_length^2) + 16*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi^2*sin(pi*abs(dif)/kernel_length)^2*cos(pi*abs(dif)/kernel_length)^2/(kernel_period^4*kernel_length^2) - 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length) + 4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif^2*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/((dif^2)^(3/2)*kernel_period^2*kernel_length)
    end

    if dorder==[1, 0, 0, 0]
        func = -4*exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)*pi*dif*sin(pi*abs(dif)/kernel_length)*cos(pi*abs(dif)/kernel_length)/(abs(dif)*kernel_period^2*kernel_length)
    end

    if dorder==[0, 0, 0, 0]
        func = exp(-2*sin(pi*abs(dif)/kernel_length)^2/kernel_period^2)
    end

    return float(func)

end